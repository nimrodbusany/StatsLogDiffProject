digraph Automaton {
initial [shape=box,label="0"];
1 [shape=circle,label="1"]
2 [shape=circle,label="2"]
3 [shape=circle,label="3"]
4 [shape=circle,label="4"]
5 [shape=circle,label="5"]
6 [shape=circle,label="6"]
7 [shape=circle,label="7"]
8 [shape=circle,label="8"]
9 [shape=circle,label="9"]
10 [shape=circle,label="10"]
11 [shape=circle,label="11"]
12 [shape=circle,label="12"]
13 [shape=circle,label="13"]
14 [shape=circle,label="14"]
15 [shape=circle,label="15"]
16 [shape=circle,label="16"]
17 [shape=doublecircle,label="17"]
18 [shape=circle,label="18"]
19 [shape=circle,label="19"]
20 [shape=circle,label="20"]
initial -> 1
1 -> 2 [label="CONNECT!"]
2 -> 3 [label="VERSION?"]
2 -> 4 [label="VERSION!"]
3 -> 5 [label="VERSION!"]
4 -> 5 [label="VERSION?"]
5 -> 6 [label="KEXINIT?"]
5 -> 8 [label="KEXDH_INIT!"]
5 -> 7 [label="KEXINIT!"]
6 -> 9 [label="KEXINIT!"]
6 -> 10 [label="KEXDH_INIT!"]
7 -> 9 [label="KEXINIT?"]
7 -> 11 [label="KEXDH_INIT!"]
8 -> 10 [label="KEXINIT!"]
8 -> 12 [label="KEXDH_REPLY?"]
8 -> 11 [label="KEXINIT!"]
9 -> 13 [label="KEXDH_INIT!"]
10 -> 14 [label="KEXINIT!"]
10 -> 15 [label="KEXDH_REPLY?"]
11 -> 14 [label="KEXINIT?"]
11 -> 16 [label="KEXDH_REPLY?"]
12 -> 15 [label="KEXINIT?"]
12 -> 16 [label="KEXINIT!"]
13 -> 17 [label="KEXDH_REPLY?"]
14 -> 17 [label="KEXDH_REPLY?"]
15 -> 17 [label="KEXINIT?"]
16 -> 17 [label="KEXINIT?"]
15 -> 18 [label="NEWKEYS?"]
15 -> 19 [label="NEWKEYS!"]
16 -> 18 [label="NEWKEYS?"]
16 -> 19 [label="NEWKEYS!"]
18 -> 20 [label="NEWKEYS!"]
19 -> 20 [label="NEWKEYS?"]
20 -> 17 [label="KEXINIT!|KEXINIT?"]
}